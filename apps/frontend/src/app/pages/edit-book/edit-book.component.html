<div class="max-w-xl mx-auto p-4 space-y-4">
  <h1 class="text-xl font-semibold">Редактировать книгу</h1>

  @if(loading){
    <div class="opacity-70">Загрузка…</div>
  } @else {
    <div class="rounded-xl border p-4 space-y-3">
      <div class="font-medium">Обложка</div>

      @if(coverUrl){
        <img [src]="coverSrc(coverUrl)" alt="Обложка" class="w-full max-h-80 object-cover rounded-lg border" />
      } @else {
        <div class="text-sm opacity-70">Обложка не загружена</div>
      }

      <div class="flex flex-wrap gap-2 items-center">
        <label class="px-3 py-2 rounded-lg bg-black text-white cursor-pointer disabled:opacity-40"
               [class.opacity-40]="busy">
          {{ loading || busy ? "Загрузка…" : (coverUrl ? "Заменить" : "Загрузить") }}
          <input type="file" accept="image/*" class="hidden" (change)="onFile($event)" [disabled]="busy" />
        </label>

        @if(coverUrl){
          <button
            class="px-3 py-2 rounded-lg bg-black/10"
            (click)="deleteCover()"
            [disabled]="busy"
          >
            Удалить
          </button>
        }
      </div>

      <div class="text-xs opacity-60">Поддерживаются изображения до 2 МБ</div>
    </div>

    <div class="rounded-xl border p-4 space-y-3">
      <label class="block">
        <div class="text-sm opacity-70 mb-1">Название</div>
        <input [(ngModel)]="title" class="w-full border rounded-lg px-3 py-2" name="title"/>
      </label>

      <label class="block">
        <div class="text-sm opacity-70 mb-1">Автор</div>
        <input [(ngModel)]="author" class="w-full border rounded-lg px-3 py-2" name="author"/>
      </label>

      <label class="block">
        <div class="text-sm opacity-70 mb-1">Описание (опционально)</div>
        <textarea [(ngModel)]="description" class="w-full border rounded-lg px-3 py-2" name="description" rows="5"></textarea>
      </label>

      @if(error){
        <div class="text-red-600">{{ error }}</div>
      }

      <button
        (click)="submit()"
        [disabled]="!canSubmit()"
        class="px-3 py-2 rounded-lg bg-black text-white disabled:opacity-40"
      >
        {{ busy ? "Сохранение…" : "Сохранить" }}
      </button>
    </div>
  }
</div>
