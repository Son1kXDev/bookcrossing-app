<div class="max-w-4xl mx-auto p-4 space-y-4">
  <header class="flex items-center justify-between">
    <h1 class="text-xl font-semibold">Мои книги</h1>
    <a class="px-3 py-2 rounded-lg bg-black text-white" routerLink="/books/new">Добавить книгу</a>
  </header>

  @if(loading){
    <div class="opacity-70">Загрузка…</div>
  } @else if(error){
    <div class="text-red-600">{{ error }}</div>
  } @else {
    <div class="grid gap-3">
      <div class="rounded-xl border p-4">
        @for(b of books; track b.id){
          <div class="rounded-xl border p-4 space-y-2">
            <div class="flex items-start justify-between gap-3">
              <div class="flex gap-3 items-start">
                @if(b.coverUrl){
                  <img
                    class="h-20 w-16 rounded-lg object-cover border"
                    [src]="coverSrc(b.coverUrl)"
                    alt="cover"
                  />
                } @else {
                  <div class="h-20 w-16 rounded-lg text-center border bg-black/5 flex items-center justify-center text-xs opacity-60">
                    Обложка отсутствует
                  </div>
                }
              <div>
                <div class="font-medium">{{ b.title }}</div>
                @if(b.author){ <div class="text-sm opacity-70">Автор: {{ b.author }}</div> }
                <div class="text-sm opacity-70">Статус: {{ statusLabel(b.status) }}</div>
              </div>
              </div>

              <div class="flex gap-2">
                <a
                  class="px-3 py-2 rounded-lg bg-black/10"
                  [class.opacity-40]="b.status === 'reserved'"
                  [class.pointer-events-none]="b.status !== 'available' && b.status != 'exchanged'"
                  [routerLink]="['/books', b.id, 'edit']"
                >
                  Редактировать
                </a>

                <button
                  class="px-3 py-2 rounded-lg bg-red-600 text-white disabled:opacity-40"
                  [disabled]="(b.status === 'reserved') || busyId === b.id"
                  (click)="remove(b)"
                >
                  {{ busyId === b.id ? "Удаление…" : "Удалить" }}
                </button>
              </div>
            </div>
          </div>
        }
      </div>
    </div>
  }
</div>
